<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="JAVA Spring @Async 비동기 테스트하기" /><meta property="og:locale" content="en" /><meta name="description" content="팀바팀 서비스에는 일정 관리 기능이 있고, 우리 서비스를 이용해 일정을 등록한 사용자들이 팀바팀을 통해 등록한 일정을 사용자들의 개인 캘린더에서도 확인할 수 있게 할 필요성을 느끼게 되었다. 그래서 직접 일정전송 표준인 icalendar (.ics)형식으로 일정 파일을 배포하게 되었다. 해당 기능은 우리의 주요 비지니스와 분리되어 실행되어야 하기에 트랜젝션과 스레드를 모두 분리하여 실행하게 되었고, 이를 위해서 spring의 @Async 어노테이션을 달아 메서드를 구현하게 되었다." /><meta property="og:description" content="팀바팀 서비스에는 일정 관리 기능이 있고, 우리 서비스를 이용해 일정을 등록한 사용자들이 팀바팀을 통해 등록한 일정을 사용자들의 개인 캘린더에서도 확인할 수 있게 할 필요성을 느끼게 되었다. 그래서 직접 일정전송 표준인 icalendar (.ics)형식으로 일정 파일을 배포하게 되었다. 해당 기능은 우리의 주요 비지니스와 분리되어 실행되어야 하기에 트랜젝션과 스레드를 모두 분리하여 실행하게 되었고, 이를 위해서 spring의 @Async 어노테이션을 달아 메서드를 구현하게 되었다." /><link rel="canonical" href="https://pilyang.github.io/posts/test-async-method/" /><meta property="og:url" content="https://pilyang.github.io/posts/test-async-method/" /><meta property="og:site_name" content="필립" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-08T17:05:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="JAVA Spring @Async 비동기 테스트하기" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-10-08T17:05:00+09:00","datePublished":"2023-10-08T17:05:00+09:00","description":"팀바팀 서비스에는 일정 관리 기능이 있고, 우리 서비스를 이용해 일정을 등록한 사용자들이 팀바팀을 통해 등록한 일정을 사용자들의 개인 캘린더에서도 확인할 수 있게 할 필요성을 느끼게 되었다. 그래서 직접 일정전송 표준인 icalendar (.ics)형식으로 일정 파일을 배포하게 되었다. 해당 기능은 우리의 주요 비지니스와 분리되어 실행되어야 하기에 트랜젝션과 스레드를 모두 분리하여 실행하게 되었고, 이를 위해서 spring의 @Async 어노테이션을 달아 메서드를 구현하게 되었다.","headline":"JAVA Spring @Async 비동기 테스트하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://pilyang.github.io/posts/test-async-method/"},"url":"https://pilyang.github.io/posts/test-async-method/"}</script><title>JAVA Spring @Async 비동기 테스트하기 | 필립</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="필립"><meta name="application-name" content="필립"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="https://avatars.githubusercontent.com/u/30036534?v=4" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">필립</a></div><div class="site-subtitle fst-italic">서비스와 코드를 통해 소통하고 영향을 주고받자</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/pilyang" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['pilyang.dev','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>JAVA Spring @Async 비동기 테스트하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>JAVA Spring @Async 비동기 테스트하기</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1696752300" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 8, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/pilyang">필립</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2660 words" > <em>14 min</em> read</span></div></div></div><div class="post-content"><p>팀바팀 서비스에는 일정 관리 기능이 있고, 우리 서비스를 이용해 일정을 등록한 사용자들이 팀바팀을 통해 등록한 일정을 사용자들의 개인 캘린더에서도 확인할 수 있게 할 필요성을 느끼게 되었다. 그래서 직접 일정전송 표준인 icalendar (.ics)형식으로 일정 파일을 배포하게 되었다. 해당 기능은 우리의 주요 비지니스와 분리되어 실행되어야 하기에 트랜젝션과 스레드를 모두 분리하여 실행하게 되었고, 이를 위해서 spring의 <code class="language-plaintext highlighter-rouge">@Async</code> 어노테이션을 달아 메서드를 구현하게 되었다.</p><p>해당 선택의 이유와 구현 방법들은 추후 팀바팀 icalendar 배포기 포스팅을 통하여 공유하도록 하겠다.</p><p>본 글에서는 기능구현을 한 이후 비동기로 (다른 스레드에서) 처리되는 메서드의 테스트 방법에 대해서 공유한다.<br /> 결론부터 말하면 이벤트리스너의 테스트를 위해서는 SycnTaskExcutor를 이용하여 테스트가 동기적으로 처리될 수 있도록 하였고, 인수테스트에서는 AOP를 사용하여 <code class="language-plaintext highlighter-rouge">AsyncAspect</code>를 만들어 <code class="language-plaintext highlighter-rouge">@Asycn</code>메서드가 끝나는것을 기다려주는 방식으로 테스트를 진행했다.</p><h2 id="이벤트-리스너-테스트--sycntaskexecutor-사용"><span class="me-2">이벤트 리스너 테스트 : <code class="language-plaintext highlighter-rouge">SycnTaskExecutor</code> 사용</span><a href="#이벤트-리스너-테스트--sycntaskexecutor-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>테스트 코드를 보기 전 icalendar 생성 및 배포를 위해 구현된 EventListner 클래스의 일부는 아래와 같다.</p><div file="IcalendarEventListener.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="IcalendarEventListener.java"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="nd">@Slf4j</span>
<span class="nd">@Component</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IcalendarEventListener</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">IcalendarPublishService</span> <span class="n">icalendarPublishService</span><span class="o">;</span>

    <span class="o">...</span>

    <span class="nd">@Async</span>
    <span class="nd">@Transactional</span><span class="o">(</span><span class="n">propagation</span> <span class="o">=</span> <span class="nc">Propagation</span><span class="o">.</span><span class="na">REQUIRES_NEW</span><span class="o">)</span>
    <span class="nd">@TransactionalEventListener</span><span class="o">(</span><span class="n">phase</span> <span class="o">=</span> <span class="nc">TransactionPhase</span><span class="o">.</span><span class="na">AFTER_COMMIT</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createIcalendar</span><span class="o">(</span><span class="kd">final</span> <span class="nc">CreateIcalendarEvent</span> <span class="n">createIcalendarEvent</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="nc">Long</span> <span class="n">teamPlaceId</span> <span class="o">=</span> <span class="n">createIcalendarEvent</span><span class="o">.</span><span class="na">teamPlaceId</span><span class="o">();</span>

        <span class="n">icalendarPublishService</span><span class="o">.</span><span class="na">createAndPublishIcalendar</span><span class="o">(</span><span class="n">teamPlaceId</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"ics파일 생성 - teamPlaceId : {}"</span><span class="o">,</span> <span class="n">teamPlaceId</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Async</span>
    <span class="nd">@Transactional</span><span class="o">(</span><span class="n">propagation</span> <span class="o">=</span> <span class="nc">Propagation</span><span class="o">.</span><span class="na">REQUIRES_NEW</span><span class="o">)</span>
    <span class="nd">@TransactionalEventListener</span><span class="o">(</span><span class="n">phase</span> <span class="o">=</span> <span class="nc">TransactionPhase</span><span class="o">.</span><span class="na">AFTER_COMMIT</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateIcalendar</span><span class="o">(</span><span class="kd">final</span> <span class="nc">ScheduleEvent</span> <span class="n">scheduleEvent</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="nc">Long</span> <span class="n">teamPlaceId</span> <span class="o">=</span> <span class="n">scheduleEvent</span><span class="o">.</span><span class="na">getTeamPlaceId</span><span class="o">();</span>

        <span class="n">icalendarPublishService</span><span class="o">.</span><span class="na">updateIcalendar</span><span class="o">(</span><span class="n">teamPlaceId</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"ics파일 업데이트 - teamPlaceId : {}"</span><span class="o">,</span> <span class="n">teamPlaceId</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></table></code></div></div><p>(자세한 구현에 대한 내용은 앞서 엎급한데로 추후 추가적인 포스팅을 통해서 공우하겠다.)</p><p>우선 실패하는 테스트 코드의 일부를 살펴보면 아래와 같다.</p><div file="IcalendarEventListenerTest.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="IcalendarEventListenerTest.java"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">IcalendarEventListenerTest</span> <span class="kd">extends</span> <span class="nc">ServiceTest</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ApplicationEventPublisher</span> <span class="n">applicationEventPublisher</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">IcalendarPublishService</span> <span class="n">icalendarPublishService</span><span class="o">;</span>

    <span class="o">...</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Ical생성에 성공한다."</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">successCallCreatingIcalendar</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// given</span>
        <span class="kd">final</span> <span class="nc">TeamPlace</span> <span class="no">ENGLISH_TEAM_PLACE</span> <span class="o">=</span> <span class="n">testFixtureBuilder</span><span class="o">.</span><span class="na">buildTeamPlace</span><span class="o">(</span><span class="no">ENGLISH_TEAM_PLACE</span><span class="o">());</span>

        <span class="kd">final</span> <span class="nc">CreateIcalendarEvent</span> <span class="n">createIcalendarEvent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CreateIcalendarEvent</span><span class="o">(</span><span class="no">ENGLISH_TEAM_PLACE</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

        <span class="c1">// when</span>
        <span class="n">applicationEventPublisher</span><span class="o">.</span><span class="na">publishEvent</span><span class="o">(</span><span class="n">createIcalendarEvent</span><span class="o">);</span>

        <span class="nc">TestTransaction</span><span class="o">.</span><span class="na">flagForCommit</span><span class="o">();</span>
        <span class="nc">TestTransaction</span><span class="o">.</span><span class="na">end</span><span class="o">();</span>

        <span class="c1">// then</span>
        <span class="n">verify</span><span class="o">(</span><span class="n">icalendarPublishService</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">createAndPublishIcalendar</span><span class="o">(</span><span class="no">ENGLISH_TEAM_PLACE</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="o">...</span>
<span class="o">}</span>

</pre></table></code></div></div><p>위의 테스트코드를 간단히 설명하면, EventListner의 테스트를 위해 Listhner가 들을 <code class="language-plaintext highlighter-rouge">CreateIcalendarEvent</code>를 발행해주었다. 이후 해당 이벤트리스너가 <code class="language-plaintext highlighter-rouge">TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)</code>이므로 트렌젝션을 커밋하여줄 수 있도록</p><div class="language-java nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nc">TestTransaction</span><span class="o">.</span><span class="na">flagForCommit</span><span class="o">();</span>
<span class="nc">TestTransaction</span><span class="o">.</span><span class="na">end</span><span class="o">();</span>
</pre></table></code></div></div><p>위와같이 테스트트렌젝션을 커밋을 해주었다.</p><p>만약에 해당 이벤트 발행으로 인한 다른 리스너의 영향이 걱정된다면, <code class="language-plaintext highlighter-rouge">ApplicationEventPublisher</code>를 통한 이벤트 발행이 아닌, <code class="language-plaintext highlighter-rouge">IcalendarEventListener</code>를 이용해서 직접 메서드를 실행시켜 줄 수 있다. 이경우에는 위의 <code class="language-plaintext highlighter-rouge">TestTransaction</code>을 통한 트랜젝션 커밋처리가 없어도 잘 실행되게 된다.</p><blockquote class="prompt-info"><p>사실 위와 똑같은 코드를 작성하여 테스트를 하면 일부 테스트가 그냥 성공하는 경우가 생겼다. 예상하기로는 해당 메서드 내부 코드가 워낙 단순하고 짧아서 검증단계를 거칠때 이미 메서드가 잘 수행이 되었기 때문에 성공하는것으로 생각된다.<br /> 임의로 리스너 메서드에 <code class="language-plaintext highlighter-rouge">Thread.sleep(100);</code>과 같이 짧은시간의 딜레이만 주어도 테스트가 실패함을 확인할 수 있을 것이다.</p></blockquote><p>위의 테스트가 실패하는 이유는 이벤트리스너가 <code class="language-plaintext highlighter-rouge">@Asycn</code>로 인하여 비동기로 실행이 되게 되고, 테스트코드의 검증을 하는</p><div class="language-java nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">verify</span><span class="o">(</span><span class="n">icalendarPublishService</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">createAndPublishIcalendar</span><span class="o">(</span><span class="no">ENGLISH_TEAM_PLACE</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
</pre></table></code></div></div><p>시점에 아직 메서드가 수행되지 않아서 테스트가 실패하게 된다.</p><p>이를 해결하기 위해서는 테스트코드가 해당 이벤트리스너 메서드가 종료되기까지 기다리게 하거나, 그냥 테스트메서드를 동기로 실행하게 해야한다. 이 IcalendarEventListenerTest는 여러 메서드들의 복합적인 테스트가 아닌 이벤트 리스너 메서드의 단위테스트 이기 때문에, 그냥 해당 메서드를 비동기적으로 실행할 수 있게 만들어주는것이 좋다고 생각하였다.</p><p>아래와 같은 <code class="language-plaintext highlighter-rouge">@TestConfiguration</code>을 추가하면 이제 메서드가 동기적으로 잘 실행되고 모든 테스트가 정장적으로 통과됨을 확인할 수 있다.</p><h3 id="동기-실행-테스트-코드"><span class="me-2">동기 실행 테스트 코드</span><a href="#동기-실행-테스트-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div file="IcalendarEventListenerTest" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="IcalendarEventListenerTest"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">IcalendarEventListenerTest</span> <span class="kd">extends</span> <span class="nc">ServiceTest</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ApplicationEventPublisher</span> <span class="n">applicationEventPublisher</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">IcalendarPublishService</span> <span class="n">icalendarPublishService</span><span class="o">;</span>

    <span class="nd">@TestConfiguration</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TestConfig</span> <span class="o">{</span>
        <span class="nd">@Bean</span>
        <span class="nd">@Primary</span>
        <span class="kd">public</span> <span class="nc">Executor</span> <span class="nf">executor</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">SyncTaskExecutor</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="o">...</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Ical생성에 성공한다."</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">successCallCreatingIcalendar</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// given</span>
        <span class="kd">final</span> <span class="nc">TeamPlace</span> <span class="no">ENGLISH_TEAM_PLACE</span> <span class="o">=</span> <span class="n">testFixtureBuilder</span><span class="o">.</span><span class="na">buildTeamPlace</span><span class="o">(</span><span class="no">ENGLISH_TEAM_PLACE</span><span class="o">());</span>

        <span class="kd">final</span> <span class="nc">CreateIcalendarEvent</span> <span class="n">createIcalendarEvent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CreateIcalendarEvent</span><span class="o">(</span><span class="no">ENGLISH_TEAM_PLACE</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

        <span class="c1">// when</span>
        <span class="n">applicationEventPublisher</span><span class="o">.</span><span class="na">publishEvent</span><span class="o">(</span><span class="n">createIcalendarEvent</span><span class="o">);</span>

        <span class="nc">TestTransaction</span><span class="o">.</span><span class="na">flagForCommit</span><span class="o">();</span>
        <span class="nc">TestTransaction</span><span class="o">.</span><span class="na">end</span><span class="o">();</span>

        <span class="c1">// then</span>
        <span class="n">verify</span><span class="o">(</span><span class="n">icalendarPublishService</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">createAndPublishIcalendar</span><span class="o">(</span><span class="no">ENGLISH_TEAM_PLACE</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="o">...</span>
<span class="o">}</span>

</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">SyncTaskExecutor</code>의 구현을 들어가보면 아래와 같이 문서가 작성되어있음을 확인할 수 있다.</p><blockquote><p>implementation that executes each task <i>synchronously</i> in the calling thread.<br /> Mainly intended for testing scenarios.<br /> Execution in the calling thread does have the advantage of participating in its thread context, for example the thread context class loader or the thread’s current transaction association. That said, in many cases, asynchronous execution will be preferable: choose an asynchronous TaskExecutor instead for such scenarios.</p></blockquote><p>해당 설명에도 테스트 시나리오를 위하여 각각의 task들을 스레드에서 동기적으로 실행하게 함을 알 수 있다.</p><p>위와같은 방식으로 <code class="language-plaintext highlighter-rouge">@Asycn</code> 메서드들의 단위테스트를 간단하게 할 수 있게 된다.</p><h2 id="인수테스트--asyncaspect-구현"><span class="me-2">인수테스트 : <code class="language-plaintext highlighter-rouge">AsyncAspect</code> 구현</span><a href="#인수테스트--asyncaspect-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>단위테스트는 위와같이 동기적인 상황을 만들어서 쉽게 테스트 할 수 있었다.<br /> 하지만 인수테스트는 가능한 실제 환경과 동일한(비슷한) 상황을 만들어 테스트를 하고 싶었고, <code class="language-plaintext highlighter-rouge">SyncTaskExecutor</code>를 사용하지 않고 테스트를 할 방법에 대해서 고민을 하였다.</p><p>결론적으로 테스트 중간에 <code class="language-plaintext highlighter-rouge">@Async</code>어노테이션이 달린 메서드가 실행되고 종료되기를 기다리는 <code class="language-plaintext highlighter-rouge">AsycnAspect</code>를 만들어서 사용하게 되었다.</p><h3 id="테스트-시나리오"><span class="me-2">테스트 시나리오</span><a href="#테스트-시나리오" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>사용자가 아직 ical이 배포되지 않은 팀에 대하여 ical배포 구독 url을 요청한다.<li>서버는 아직 ical이 배포가 안되어있음으로 404응답을 하고, 배포 이벤트를 발행한다.<li>일정 시간이 지난 후 사용자가 ical구독 url을 요청하면 생성된 구독 url을 응답한다.</ol><p>아래는 해당 시나리오에 해당하는 테스트코드이다.</p><div file="IcalendarAcceptanceTest.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="IcalendarAcceptanceTest.java"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">IcalendarAcceptanceTest</span> <span class="kd">extends</span> <span class="nc">AcceptanceTest</span> <span class="o">{</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">FileCloudUploader</span> <span class="n">fileCloudUploader</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">TestConfig</span><span class="o">.</span><span class="na">AsyncAspect</span> <span class="n">asyncAspect</span><span class="o">;</span>

    <span class="nd">@TestConfiguration</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TestConfig</span> <span class="o">{</span>

        <span class="nd">@Aspect</span>
        <span class="nd">@Component</span>
        <span class="kd">static</span> <span class="kd">class</span> <span class="nc">AsyncAspect</span> <span class="o">{</span>

            <span class="kd">private</span> <span class="nc">CountDownLatch</span> <span class="n">countDownLatch</span><span class="o">;</span>

            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">countDownLatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CountDownLatch</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@After</span><span class="o">(</span><span class="s">"execution(* team.teamby.teambyteam.icalendar.application.IcalendarEventListener.createIcalendar(*))"</span><span class="o">)</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterIcalendarCreation</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">countDownLatch</span><span class="o">.</span><span class="na">countDown</span><span class="o">();</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">await</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
                <span class="n">countDownLatch</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Nested</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"icalendar 배포 파일 조회시"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">IcalendarUrlGetTest</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">TeamPlace</span> <span class="n">teamPlace</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">authCode</span><span class="o">;</span>

        <span class="nd">@BeforeEach</span>
        <span class="kt">void</span> <span class="nf">setup</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">member</span> <span class="o">=</span> <span class="n">testFixtureBuilder</span><span class="o">.</span><span class="na">buildMember</span><span class="o">(</span><span class="nc">MemberFixtures</span><span class="o">.</span><span class="na">PHILIP</span><span class="o">());</span>
            <span class="n">teamPlace</span> <span class="o">=</span> <span class="n">testFixtureBuilder</span><span class="o">.</span><span class="na">buildTeamPlace</span><span class="o">(</span><span class="nc">TeamPlaceFixtures</span><span class="o">.</span><span class="na">FLUID_TEAM_PLACE</span><span class="o">());</span>
            <span class="n">testFixtureBuilder</span><span class="o">.</span><span class="na">buildMemberTeamPlace</span><span class="o">(</span><span class="n">member</span><span class="o">,</span> <span class="n">teamPlace</span><span class="o">);</span>
            <span class="n">authCode</span> <span class="o">=</span> <span class="n">jwtTokenProvider</span><span class="o">.</span><span class="na">generateAccessToken</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getEmailValue</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="o">...</span>

        <span class="nd">@Test</span>
        <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"아직 생성되지 않았으면 404예외가 발생된 후 생성이 된다."</span><span class="o">)</span>
        <span class="kt">void</span> <span class="nf">failWhenNotPublished</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
            <span class="c1">// given</span>
            <span class="kd">final</span> <span class="nc">String</span> <span class="n">generatedUrl</span> <span class="o">=</span> <span class="s">"https://assets.test.teamby.team/asset/path/icalendar.ics"</span><span class="o">;</span>
            <span class="nc">BDDMockito</span><span class="o">.</span><span class="na">given</span><span class="o">(</span><span class="n">fileCloudUploader</span><span class="o">.</span><span class="na">upload</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="kt">byte</span><span class="o">[].</span><span class="na">class</span><span class="o">),</span> <span class="n">any</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">)))</span>
                    <span class="o">.</span><span class="na">willAnswer</span><span class="o">(</span><span class="n">invocation</span> <span class="o">-&gt;</span> <span class="n">generatedUrl</span><span class="o">);</span>

            <span class="c1">// when</span>
            <span class="n">asyncAspect</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>
            <span class="kd">final</span> <span class="nc">ExtractableResponse</span><span class="o">&lt;</span><span class="nc">Response</span><span class="o">&gt;</span> <span class="n">firstResponse</span> <span class="o">=</span> <span class="no">GET_ICALENDAR_PUBLISHED_URL</span><span class="o">(</span><span class="n">authCode</span><span class="o">,</span> <span class="n">teamPlace</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
            <span class="n">asyncAspect</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>

            <span class="kd">final</span> <span class="nc">ExtractableResponse</span><span class="o">&lt;</span><span class="nc">Response</span><span class="o">&gt;</span> <span class="n">secondResponse</span> <span class="o">=</span> <span class="no">GET_ICALENDAR_PUBLISHED_URL</span><span class="o">(</span><span class="n">authCode</span><span class="o">,</span> <span class="n">teamPlace</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

            <span class="c1">// then</span>
            <span class="nc">SoftAssertions</span><span class="o">.</span><span class="na">assertSoftly</span><span class="o">(</span><span class="n">softly</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="n">softly</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span><span class="n">firstResponse</span><span class="o">.</span><span class="na">statusCode</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
                <span class="n">softly</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span><span class="n">secondResponse</span><span class="o">.</span><span class="na">statusCode</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
                <span class="n">softly</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span><span class="n">secondResponse</span><span class="o">.</span><span class="na">jsonPath</span><span class="o">().</span><span class="na">getString</span><span class="o">(</span><span class="s">"url"</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">generatedUrl</span><span class="o">);</span>
            <span class="o">});</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></table></code></div></div><p>위에서 <code class="language-plaintext highlighter-rouge">GET_ICALENDAR_PUBLISHED_URL</code> 는 <code class="language-plaintext highlighter-rouge">RestAssured</code>를 통해 요청을 보내는 부분을 메서드 분리한 것이다.</p><p>해당 테스트에서는 <code class="language-plaintext highlighter-rouge">GET_ICALENDAR_PUBLISHED_URL</code>최초 요청 후 정상적으로 url이 생성되기까지 테스트코드를 진행하지 않고, 대기하여야 한다. 이를 위해서 아래와 같은 Spring AOP를 구현하였다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nd">@TestConfiguration</span>
<span class="kd">static</span> <span class="kd">class</span> <span class="nc">TestConfig</span> <span class="o">{</span>

    <span class="nd">@Aspect</span>
    <span class="nd">@Component</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">AsyncAspect</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="nc">CountDownLatch</span> <span class="n">countDownLatch</span><span class="o">;</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">countDownLatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CountDownLatch</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nd">@After</span><span class="o">(</span><span class="s">"execution(* team.teamby.teambyteam.icalendar.application.IcalendarEventListener.createIcalendar(*))"</span><span class="o">)</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterIcalendarCreation</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">countDownLatch</span><span class="o">.</span><span class="na">countDown</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">await</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
            <span class="n">countDownLatch</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></table></code></div></div><p>해당 AOP는 <code class="language-plaintext highlighter-rouge">IcalendarEventListener</code>의 <code class="language-plaintext highlighter-rouge">createIcalendar</code>메서드가 실행이 된 이후에 countDownLatch의 숫자를 1회 카운트다운 하는 역할을 한다. 이를 이용하여 해당 <code class="language-plaintext highlighter-rouge">createIcalendar</code>메서드의 실행을 기다려야 하면, 해당 메서드를 실행하기 전 <code class="language-plaintext highlighter-rouge">init()</code> 메서드를 실행하여 CountDownLatch를 1로 초기화 한 후, <code class="language-plaintext highlighter-rouge">await()</code>메서드를 실행하여 icalendar생성 메서드가 종료되기까지를 기다리게 할 수 있다.</p><p>해당 부분의 코드는 아래와 같다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">asyncAspect</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>    <span class="c1">// CountDownLatch 초기화</span>
<span class="kd">final</span> <span class="nc">ExtractableResponse</span><span class="o">&lt;</span><span class="nc">Response</span><span class="o">&gt;</span> <span class="n">firstResponse</span> <span class="o">=</span> <span class="no">GET_ICALENDAR_PUBLISHED_URL</span><span class="o">(</span><span class="n">authCode</span><span class="o">,</span> <span class="n">teamPlace</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>    <span class="c1">// ical 생성 전 요청</span>
<span class="n">asyncAspect</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>    <span class="c1">// AOP afterIcalendarCreation 종료시까지 기다리기 (countDownLatch 가 0이 될 때까지 기다리기)</span>

<span class="kd">final</span> <span class="nc">ExtractableResponse</span><span class="o">&lt;</span><span class="nc">Response</span><span class="o">&gt;</span> <span class="n">secondResponse</span> <span class="o">=</span> <span class="no">GET_ICALENDAR_PUBLISHED_URL</span><span class="o">(</span><span class="n">authCode</span><span class="o">,</span> <span class="n">teamPlace</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>    <span class="c1">// ical 생성 후 요청</span>
</pre></table></code></div></div><h2 id="마무리"><span class="me-2">마무리</span><a href="#마무리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이처럼 스프링의 기능을 활용해서 두가지 방법을 이용해 비동기 메서드를 테스트하게 되었다.<br /> 앞으로도 각각의 상황에 맞게 해당 방법들중에 선택을 하여 (혹은 문제가 생긴다면 달느 방법을 생각해보고) 상황에 맞게 비동기 테스트를 처리하게 되면 다양한 상황에서 적절한 테스트가가 가능할 것으로 보인다.</p><p>끝!!</p><hr /><p>팀바팀은 우아한테크코스 5기 프로젝트로 진행된 프로젝트로, 한학기에 여러 종류의 팀플을 하는 대학생들이 쉽게 팀플을 할 수 있도록 도움을 주고자 하는 플렛폼 입니다.</p><p><a href="https://github.com/woowacourse-teams/2023-team-by-team">팀바팀 레포 보기</a><br /> <a href="https://teamby.team">팀바팀 서비스 써보기</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/projects/'>Projects</a>, <a href='/categories/team-by-team/'>team-by-team</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >JAVA</a> <a href="/tags/spring/" class="post-tag no-text-decoration" >Spring</a> <a href="/tags/async/" class="post-tag no-text-decoration" >Async</a> <a href="/tags/test/" class="post-tag no-text-decoration" >test</a> <a href="/tags/%EC%9E%90%EB%B0%94/" class="post-tag no-text-decoration" >자바</a> <a href="/tags/%EB%B9%84%EB%8F%99%EA%B8%B0/" class="post-tag no-text-decoration" >비동기</a> <a href="/tags/%ED%85%8C%EC%8A%A4%ED%8A%B8/" class="post-tag no-text-decoration" >테스트</a> <a href="/tags/%EC%9A%B0%ED%85%8C%EC%BD%94/" class="post-tag no-text-decoration" >우테코</a> <a href="/tags/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4/" class="post-tag no-text-decoration" >우아한테크코스</a> <a href="/tags/%ED%8C%80%EB%B0%94%ED%8C%80/" class="post-tag no-text-decoration" >팀바팀</a> <a href="/tags/team-by-team/" class="post-tag no-text-decoration" >team-by-team</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=JAVA%20Spring%20@Async%20%EB%B9%84%EB%8F%99%EA%B8%B0%20%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0%20-%20%ED%95%84%EB%A6%BD&url=https%3A%2F%2Fpilyang.github.io%2Fposts%2Ftest-async-method%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=JAVA%20Spring%20@Async%20%EB%B9%84%EB%8F%99%EA%B8%B0%20%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0%20-%20%ED%95%84%EB%A6%BD&u=https%3A%2F%2Fpilyang.github.io%2Fposts%2Ftest-async-method%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fpilyang.github.io%2Fposts%2Ftest-async-method%2F&text=JAVA%20Spring%20@Async%20%EB%B9%84%EB%8F%99%EA%B8%B0%20%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0%20-%20%ED%95%84%EB%A6%BD" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/async/">Async</a> <a class="post-tag btn btn-outline-primary" href="/tags/java/">JAVA</a> <a class="post-tag btn btn-outline-primary" href="/tags/spring/">Spring</a> <a class="post-tag btn btn-outline-primary" href="/tags/team-by-team/">team-by-team</a> <a class="post-tag btn btn-outline-primary" href="/tags/test/">test</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B9%84%EB%8F%99%EA%B8%B0/">비동기</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4/">우아한테크코스</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9A%B0%ED%85%8C%EC%BD%94/">우테코</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9E%90%EB%B0%94/">자바</a> <a class="post-tag btn btn-outline-primary" href="/tags/%ED%85%8C%EC%8A%A4%ED%8A%B8/">테스트</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/HELLO_WORLD/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1692706440" data-df="ll" > Aug 22, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Hello World</h4><div class="text-muted small"><p> 필립 블로그 오픈합니다~</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HELLO_WORLD/" class="btn btn-outline-primary" prompt="Older" ><p>Hello World</p></a><div class="btn btn-outline-primary disabled" prompt="Newer" ><p>-</p></div></div><script src="https://utteranc.es/client.js" repo="pilyang/pilyang.github.io" issue-term="pathname" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/async/">Async</a> <a class="post-tag btn btn-outline-primary" href="/tags/java/">JAVA</a> <a class="post-tag btn btn-outline-primary" href="/tags/spring/">Spring</a> <a class="post-tag btn btn-outline-primary" href="/tags/team-by-team/">team-by-team</a> <a class="post-tag btn btn-outline-primary" href="/tags/test/">test</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B9%84%EB%8F%99%EA%B8%B0/">비동기</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4/">우아한테크코스</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9A%B0%ED%85%8C%EC%BD%94/">우테코</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9E%90%EB%B0%94/">자바</a> <a class="post-tag btn btn-outline-primary" href="/tags/%ED%85%8C%EC%8A%A4%ED%8A%B8/">테스트</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a></p><p>© 2023 <a href="https://github.com/pilyang">필립</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
